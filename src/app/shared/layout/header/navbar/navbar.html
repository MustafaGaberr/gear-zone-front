<nav class="navbar navbar-expand-md navbar-dark sticky-top" [ngClass]="transparent ? 'bg-transparent' : 'navbar-bg shadow'">
  <div class="container">
    <a routerLink="/home" class="navbar-brand">
      <img [src]="logoImage" alt="GearZone" height="40" />
    </a>

    <button
      class="navbar-toggler border-0"
      type="button"
      (click)="toggleMobileMenu()"
      aria-label="Toggle navigation"
    >
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" [ngClass]="{ 'show': isMobileMenuOpen }">
      <ul class="navbar-nav mx-auto mb-2 mb-md-0">
        <li class="nav-item">
          <a routerLink="/home" class="nav-link nav-link-custom" (click)="closeMobileMenu()">Home</a>
        </li>
        <li class="nav-item">
          <a routerLink="/products" class="nav-link nav-link-custom" (click)="closeMobileMenu()">Products</a>
        </li>
        <li class="nav-item">
          <a routerLink="/contact" class="nav-link nav-link-custom" (click)="closeMobileMenu()">Contact</a>
        </li>
      </ul>

      <div class="d-flex align-items-center gap-3">
        
        @if (authService.userData(); as user) {
          
          <button
            (click)="toggleNotification()"
            class="btn btn-link text-white p-0 position-relative"
          >
            <i class="bi bi-bell fs-5"></i>
            
            @if (notifications > 0) {
              <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger">
                {{ notifications }}
              </span>
            }
          </button>

          <a
            [routerLink]="['/', (user.type || 'user') + '-dashboard', 'messages']"
            class="btn btn-link text-white p-0 position-relative"
          >
            <i class="bi bi-chat-dots fs-5"></i>
            
            @if (messages > 0) {
              <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger">
                {{ messages }}
              </span>
            }
          </a>

          <a
            [routerLink]="['/', (user.type || 'user') + '-dashboard', 'profile']"
            class="d-flex align-items-center gap-2 text-white text-decoration-none"
          >
            @if (user.avatar) {
              <img
                [src]="user.avatar"
                [alt]="user.name"
                class="rounded-circle"
                width="32"
                height="32"
              />
            } @else {
              <i class="bi bi-person-circle fs-5"></i>
            }
            
            <span class="d-none d-lg-inline">{{ user.name }}</span>
          </a>

        } @else {
          <a
            routerLink="/login"
            class="nav-link nav-link-custom d-none d-md-block"
            (click)="closeMobileMenu()"
          >
            Login
          </a>
          <a
            routerLink="/register"
            class="btn btn-primary rounded-3 px-4 d-none d-md-block"
            (click)="closeMobileMenu()"
          >
            Register
          </a>
        }

        <button 
          routerLink="/cart"
          class="btn btn-link text-white p-0 position-relative"
        >
          <i class="bi bi-cart3 fs-5"></i>
          
          @if (cartItemCount > 0) {
            <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-orange">
              {{ cartItemCount }}
            </span>
          }
        </button>
      </div>

      @if (!authService.userData()) {
        <div class="d-md-none border-top border-secondary mt-3 pt-3">
          <div class="d-grid gap-2">
            <a
              routerLink="/login"
              class="btn btn-outline-light"
              (click)="closeMobileMenu()"
            >
              Login
            </a>
            <a
              routerLink="/register"
              class="btn btn-primary"
              (click)="closeMobileMenu()"
            >
              Register
            </a>
          </div>
        </div>
      }
      
    </div>
  </div>
</nav>