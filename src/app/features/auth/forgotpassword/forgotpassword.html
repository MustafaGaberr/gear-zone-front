<div class="auth-background">
    <div class="forgot-container">
        <img src="assets/images/logo.png" alt="GearZone Logo">
        <div class="forgot-form">

            @if (!isSuccess) {
            <!-- Form State -->
            <div class="header">
                <div class="icon-wrapper">
                    <i class="bi bi-key"></i>
                </div>
                <h1>{{ translationService.currentLang() === 'ar' ? 'نسيت كلمة المرور؟' : 'Forgot Password?' }}</h1>
                <p>{{ translationService.currentLang() === 'ar' ? 'أدخل بريدك الإلكتروني وسنرسل لك رابط إعادة تعيين' :
                    'Enter your email and we\'ll send you a reset link' }}</p>
            </div>

            <form [formGroup]="forgotForm" (ngSubmit)="onSubmit()">
                <div class="input-field">
                    @let emailControl = forgotForm.get('email');
                    <p>{{ translationService.translate('auth.email') }}</p>
                    <div class="input-wrapper">
                        <i class="bi bi-envelope input-icon"></i>
                        <input type="email" formControlName="email"
                            [placeholder]="translationService.currentLang() === 'ar' ? 'بريدك@الإلكتروني.com' : 'your@email.com'"
                            [class]="{'border-success': emailControl?.valid, 'border-danger': emailControl?.invalid && emailControl?.touched}">
                    </div>
                    @if (emailControl?.errors && emailControl?.touched) {
                    <div class="error-message">
                        @if (emailControl?.getError('required')) {
                        <span>{{ translationService.currentLang() === 'ar' ? 'البريد الإلكتروني مطلوب' : 'Email is
                            required' }}</span>
                        }
                        @if (emailControl?.getError('email')) {
                        <span>{{ translationService.currentLang() === 'ar' ? 'يرجى إدخال بريد إلكتروني صحيح' : 'Please
                            enter a valid email' }}</span>
                        }
                    </div>
                    }
                </div>

                <button type="submit" class="submit-btn" [disabled]="isSubmitting">
                    @if (isSubmitting) {
                    <span class="spinner-border spinner-border-sm" role="status"></span>
                    {{ translationService.currentLang() === 'ar' ? 'جاري الإرسال...' : 'Sending...' }}
                    } @else {
                    {{ translationService.currentLang() === 'ar' ? 'إرسال رابط إعادة التعيين' : 'Send Reset Link' }}
                    <i class="bi bi-send ms-2"></i>
                    }
                </button>
            </form>

            } @else {
            <!-- Success State -->
            <div class="success-state">
                <div class="success-icon">
                    <i class="bi bi-check-lg"></i>
                </div>
                <h2>{{ translationService.currentLang() === 'ar' ? 'تحقق من بريدك الإلكتروني' : 'Check Your Email' }}
                </h2>
                <p>{{ translationService.currentLang() === 'ar' ? 'لقد أرسلنا رابط إعادة تعيين كلمة المرور إلى بريدك
                    الإلكتروني. يرجى التحقق من صندوق الوارد.' : 'We\'ve sent a password reset link to your email
                    address. Please check your inbox.' }}</p>

                <div class="email-info">
                    <i class="bi bi-envelope-check"></i>
                    <span>{{ forgotForm.get('email')?.value }}</span>
                </div>
            </div>
            }

            <a routerLink="/login" class="back-to-login">
                <i class="bi bi-arrow-left"></i>
                {{ translationService.currentLang() === 'ar' ? 'العودة لتسجيل الدخول' : 'Back to Login' }}
            </a>
        </div>
    </div>
</div>